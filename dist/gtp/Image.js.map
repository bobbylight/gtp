{"version":3,"sources":["gtp/Image.ts"],"names":["gtp","gtp.Image","gtp.Image.constructor","gtp.Image._ensure256Square","gtp.Image.draw","gtp.Image.drawScaled","gtp.Image.drawScaled2","gtp.Image.makeColorTranslucent","gtp.Image.width","gtp.Image.height"],"mappings":"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","file":"gtp/Image.js","sourcesContent":["module gtp {\r\n\t'use strict';\r\n\r\n\texport class Image {\r\n\r\n\t\tprivate _canvas: HTMLCanvasElement;\r\n\t\tx: number;\r\n\t\ty: number;\r\n\t\tprivate _width: number;\r\n\t\tprivate _height: number;\r\n\r\n\t\t/**\r\n\t\t * A wrapper around images.  Handles browser-specific quirks and other things\r\n\t\t * a game shouldn't have to know about.\r\n\t\t *\r\n\t\t * @constructor\r\n\t\t */\r\n\t\tconstructor(canvas: HTMLCanvasElement, x?: number, y?: number, w?: number, h?: number) {\r\n\t\t\tthis._canvas = canvas;\r\n\t\t\tif (x != null && y != null && w != null && h != null) {\r\n\t\t\t\tthis.x = x;\r\n\t\t\t\tthis.y = y;\r\n\t\t\t\tthis._width = w;\r\n\t\t\t\tthis._height = h;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.x = this.y = 0;\r\n\t\t\t\tthis._width = this._canvas.width;\r\n\t\t\t\tthis._height = this._canvas.height;\r\n\t\t\t}\r\n\t\t\tthis._ensure256Square();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Chrome has trouble copying from a canvas in RAM to a canvas in GPU memory\r\n\t\t * and vice versa, unless all canvases are >= 256x256.\r\n\t\t */\r\n\t\t_ensure256Square() {\r\n\t\t\tif (this._canvas.width < 256 || this._canvas.height < 256) {\r\n\t\t\t\tvar w = Math.max(256, this._canvas.width);\r\n\t\t\t\tvar h = Math.max(256, this._canvas.height);\r\n\t\t\t\tvar canvas2 = gtp.ImageUtils.createCanvas(w, h);\r\n\t\t\t\tvar ctx2 = canvas2.getContext('2d');\r\n\t\t\t\tctx2.drawImage(this._canvas, 0, 0);\r\n\t\t\t\tthis._canvas = canvas2;\r\n\t\t\t}\r\n\t\t}\r\n   \r\n\t\t/**\r\n\t\t * Draws this image.\r\n\t\t * \r\n\t\t * @param {CanvasRenderingContext2D} ctx A canvas' graphics context.\r\n\t\t * @param {int} x The x-coordinate at which to draw.\r\n\t\t * @param {int} y The y-coordinate at which to draw.\r\n\t\t */\r\n\t\tdraw(ctx: CanvasRenderingContext2D, x: number, y: number) {\r\n\t\t\tctx.drawImage(this._canvas, this.x, this.y, this._width, this._height,\r\n\t\t\t\tx, y, this._width, this._height);\r\n\t\t}\r\n   \r\n\t\t/**\r\n\t\t * Draws this image.\r\n\t\t * \r\n\t\t * @param {CanvasRenderingContext2D} ctx A canvas' graphics context.\r\n\t\t * @param {int} x The x-coordinate at which to draw.\r\n\t\t * @param {int} y The y-coordinate at which to draw.\r\n\t\t * @param {int} w The width to (possibly) stretch the image to when\r\n\t\t *              drawing.\r\n\t\t * @param {int} h The height to (possibly) stretch the image to when\r\n\t\t *              drawing.\r\n\t\t */\r\n\t\tdrawScaled(ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) {\r\n\t\t\tctx.drawImage(this._canvas, this.x, this.y, this._width, this._height,\r\n\t\t\t\tx, y, w, h);\r\n\t\t}\r\n   \r\n\t\t/**\r\n\t\t * Draws this image.\r\n\t\t * \r\n\t\t * @param {CanvasRenderingContext2D} ctx A canvas' graphics context.\r\n\t\t * @param {int} srcX The x-coordinate at which to draw.\r\n\t\t * @param {int} srcY The y-coordinate at which to draw.\r\n\t\t * @param {int} srcW The width of the (possibly) sub-image to draw.\r\n\t\t * @param {int} srcH The height of the (possibly) sub-image to draw.\r\n\t\t * @param {int} destX The x-coordinate at which to draw.\r\n\t\t * @param {int} destY The y-coordinate at which to draw.\r\n\t\t * @param {int} destW The width to (possibly) stretch the image to when\r\n\t\t *              drawing.\r\n\t\t * @param {int} destH The height to (possibly) stretch the image to when\r\n\t\t *              drawing.\r\n\t\t */\r\n\t\tdrawScaled2(ctx: CanvasRenderingContext2D, srcX: number, srcY: number, srcW: number, srcH: number,\r\n\t\t\tdestX: number, destY: number, destW: number, destH: number) {\r\n\t\t\tsrcX = this.x + srcX;\r\n\t\t\tsrcY = this.y + srcY;\r\n\t\t\tctx.drawImage(this._canvas, srcX, srcY, srcW, srcH,\r\n\t\t\t\tdestX, destY, destW, destH);\r\n\t\t}\r\n   \r\n\t\t/**\r\n\t\t * Converts a color of a particular type to completely transparent in this\r\n\t\t * image.\r\n\t\t * \r\n\t\t * @param {int} x The x-coordinate of the pixel whose color to change.  0 will\r\n\t\t *        be used if this parameter is undefined.\r\n\t\t * @param {int} y The y-coordinate of the pixel whose color to change.  0 will\r\n\t\t *        be used if this parameter is undefined.\r\n\t\t * @return {Image} This image, which has been modified.\r\n\t\t * @method\r\n\t\t */\r\n\t\tmakeColorTranslucent(x: number = 0, y: number = 0) {\r\n\t\t\tgtp.ImageUtils.makeColorTranslucent(this._canvas, x, y);\r\n\t\t}\r\n   \r\n\t\tget width() : number {\r\n\t\t\treturn this._width;\r\n\t\t}\r\n   \r\n\t\tget height() : number {\r\n\t\t\treturn this._height;\r\n\t\t}\r\n\r\n\t}\r\n}"],"sourceRoot":"/source/"}